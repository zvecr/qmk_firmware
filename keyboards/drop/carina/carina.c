// Copyright 2022 zvecr <git@zvecr.com>
// SPDX-License-Identifier: GPL-2.0-or-later

#include "quantum.h"

void keyboard_pre_init_kb(void) {
    // common init
    void keyboard_pre_init_vendor(void);
    keyboard_pre_init_vendor();

    keyboard_pre_init_user();
}

#ifdef RGB_MATRIX_ENABLE
const is31_led PROGMEM g_is31_leds[DRIVER_LED_TOTAL] = {
    { 1, B_9, A_9, C_9 },
    { 1, B_8, A_8, C_8 },
    { 1, E_8, D_8, F_8 },
    { 1, B_7, A_7, C_7 },
    { 1, B_5, A_5, C_5 },
    { 1, E_5, D_5, F_5 },
    { 1, B_3, A_3, C_3 },
    { 0, B_12, A_12, C_12 },
    { 0, B_11, A_11, C_11 },
    { 0, B_9, A_9, C_9 },
    { 0, B_8, A_8, C_8 },
    { 0, B_7, A_7, C_7 },
    { 0, E_7, D_7, F_7 },
    { 0, B_5, A_5, C_5 },
    { 1, H_9, G_9, I_9 },
    { 1, K_8, J_8, L_8 },
    { 1, H_7, G_7, I_7 },
    { 1, K_7, J_7, L_7 },
    { 1, K_5, J_5, L_5 },
    { 1, E_3, D_3, F_3 },
    { 1, K_3, J_3, L_3 },
    { 0, H_12, G_12, I_12 },
    { 0, H_11, G_11, I_11 },
    { 0, H_9, G_9, I_9 },
    { 0, H_8, G_8, I_8 },
    { 0, H_7, G_7, I_7 },
    { 0, K_5, J_5, L_5 },
    { 0, E_3, D_3, F_3 },
    { 1, K_11, J_11, L_11 },
    { 1, H_11, G_11, I_11 },
    { 1, B_11, A_11, C_11 },
    { 1, E_11, D_11, F_11 },
    { 1, E_2, D_2, F_2 },
    { 1, H_2, G_2, I_2 },
    { 1, K_2, J_2, L_2 },
    { 0, K_12, J_12, L_12 },
    { 0, K_11, J_11, L_11 },
    { 0, K_9, J_9, L_9 },
    { 0, K_8, J_8, L_8 },
    { 0, K_7, J_7, L_7 },
    { 0, B_3, A_3, C_3 },
    { 1, H_12, G_12, I_12 },
    { 1, K_13, J_13, L_13 },
    { 1, K_14, J_14, L_14 },
    { 1, H_14, G_14, I_14 },
    { 1, H_16, G_16, I_16 },
    { 1, K_16, J_16, L_16 },
    { 0, K_13, J_13, L_13 },
    { 0, H_13, G_13, I_13 },
    { 0, H_14, G_14, I_14 },
    { 0, K_14, J_14, L_14 },
    { 0, K_16, J_16, L_16 },
    { 0, K_2, J_2, L_2 },
    { 1, B_12, A_12, C_12 },
    { 1, B_13, A_13, C_13 },
    { 1, E_13, D_13, F_13 },
    { 1, B_16, A_16, C_16 },
    { 0, B_14, A_14, C_14 },
    { 0, B_16, A_16, C_16 },
    { 0, H_2, G_2, I_2 },
    { 0, B_2, A_2, C_2 },
    { 1, E_9, D_9, F_9 },
    { 1, H_8, G_8, I_8 },
    { 1, E_7, D_7, F_7 },
    { 1, H_5, G_5, I_5 },
    { 1, H_3, G_3, I_3 },
    { 0, E_12, D_12, F_12 },
    { 0, E_11, D_11, F_11 },
    { 0, E_9, D_9, F_9 },
    { 0, E_8, D_8, F_8 },
    { 0, H_5, G_5, I_5 },
    { 0, E_5, D_5, F_5 },
    { 1, E_12, D_12, F_12 },
    { 1, H_13, G_13, I_13 },
    { 1, E_14, D_14, F_14 },
    { 1, B_14, A_14, C_14 },
    { 1, E_16, D_16, F_16 },
    { 0, B_13, A_13, C_13 },
    { 0, E_13, D_13, F_13 },
    { 0, E_14, D_14, F_14 },
    { 0, E_16, D_16, F_16 },
    { 0, H_16, G_16, I_16 },
    { 0, E_2, D_2, F_2 },
    { 1, K_9, J_9, L_9 },
    { 1, K_12, J_12, L_12 },
    { 0, H_3, G_3, I_3 },
    { 0, K_3, J_3, L_3 },
};

led_config_t g_led_config = {
  {
    {  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13 },
    { 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27 },
    { 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, NO_LED, 40 },
    { 41, NO_LED, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, NO_LED, 52 },
    { 53, 54, 55, NO_LED, NO_LED, NO_LED, 56, NO_LED, NO_LED, NO_LED, 57, 58, 59, 60 }
  },
  {
    {   8, 56 },
    {  22, 56 },
    {  35, 56 },
    {  49, 56 },
    {  63, 56 },
    {  77, 56 },
    {  91, 56 },
    { 105, 56 },
    { 118, 56 },
    { 132, 56 },
    { 146, 56 },
    { 160, 56 },
    { 174, 56 },
    { 195, 56 },

    {  11, 44 },
    {  28, 44 },
    {  42, 44 },
    {  56, 44 },
    {  70, 44 },
    {  84, 44 },
    {  98, 44 },
    { 112, 44 },
    { 125, 44 },
    { 139, 44 },
    { 153, 44 },
    { 167, 44 },
    { 181, 44 },
    { 198, 44 },

    {  13, 32 },
    {  32, 32 },
    {  46, 32 },
    {  60, 32 },
    {  73, 32 },
    {  87, 32 },
    { 101, 32 },
    { 115, 32 },
    { 129, 32 },
    { 143, 32 },
    { 156, 32 },
    { 170, 32 },
    // ___
    { 193, 32 },

    {  16, 19 },
    {  39, 19 },
    {  53, 19 },
    {  67, 19 },
    {  80, 19 },
    {  94, 19 },
    { 108, 19 },
    { 122, 19 },
    { 136, 19 },
    { 150, 19 },
    { 163, 19 },
    // ___
    { 182, 19 },

    {   9,  7 },
    {  27,  7 },
    {  44,  7 },
    // ___
    // ___
    // ___
    {  96,  7 },
    // ___
    // ___
    // ___
    { 148,  7 },
    { 165,  7 },
    { 188,  7 },
    { 201,  7 },

    // Underglow
    {  15, 49 },
    {  35, 49 },
    {  53, 49 },
    {  70, 49 },
    {  88, 49 },
    { 106, 49 },
    { 124, 49 },
    { 142, 49 },
    { 161, 49 },
    { 179, 49 },
    { 197, 49 },
    {  15, 12 },
    {  35, 12 },
    {  53, 12 },
    {  70, 12 },
    {  88, 12 },
    { 106, 12 },
    { 124, 12 },
    { 142, 12 },
    { 161, 12 },
    { 176, 12 },
    { 194, 12 },
    {  15, 37 },
    {  15, 25 },
    { 197, 37 },
    { 197, 25 }
  },
  {
    1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
    4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
    4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,    1,
    4,    4, 4, 4, 4, 4, 4, 4, 4, 4, 4,    4,
    1, 1, 1,          4,          1, 1, 1, 1,

    // 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    // 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    // 2, 2, 2, 2, 2, 2
    0x80|2, 2, 0x80|2, 2, 0x80|2, 2, 0x80|2, 2, 0x80|2, 2, 0x80|2,
    2, 0x80|2, 2, 0x80|2, 2, 0x80|2, 2, 0x80|2, 2, 0x80|2, 2,
    2, 0x80|2, 2, 0x80|2
  }
};

__attribute__ ((weak))
void rgb_matrix_indicators_user(void) {
    if (host_keyboard_led_state().caps_lock) {
        rgb_matrix_set_color(28, 0xFF, 0xFF, 0xFF);
    }
}
#endif
